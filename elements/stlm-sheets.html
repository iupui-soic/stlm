<link rel="import" href="../bower_components/polymer/polymer-element.html">

<link rel="import" href="../bower_components/hot-table/hot-table.html">


<dom-module id="stlm-sheets">

    <template items="[[spreadsheets]]">
        <style>
            :host {
                display: block;
            }

        </style>
        <div style="float:right">
            <button id="addbutton" onclick="addColumn()">+</button>
        </div>
        <div1 style="float:left">
            <hot-table datarows="{{itemsArray}}" id='table' width="100%">
                <hot-column></hot-column>
                <hot-column></hot-column>
                <hot-column></hot-column>
            </hot-table>
            <button id="submit" onclick="saveContent()">SUBMIT</button>
        </div1>

        <script>
            function addColumn() {
                var table = document.getElementsByTagName('stlm-sheets')[0].shadowRoot.getElementById('table');
                table.innerHTML += '<hot-column></hot-column>';

            }

            function saveContent() {
                var ht = new Handsontable(document.getElementsByTagName('stlm-sheets')[0].shadowRoot.getElementById('table'));
                localStorage.setItem('tabledata', ht.getData());
                console.log(ht.getData());
            }


        </script>

    </template>

    <script>
        class StlmSheets extends Polymer.Element {
            static get is() {
                return 'stlm-sheets';
            }

            constructor(){
                super();
                this.itemsArray=[{}, {}, {}];
            }


        }

        window.customElements.define(StlmSheets.is, StlmSheets);
    </script>
</dom-module>